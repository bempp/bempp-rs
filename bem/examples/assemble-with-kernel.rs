use approx::*;
use std::time::Instant;

use bempp_bem::assembly::{assemble_dense, BoundaryOperator, PDEType};
use bempp_bem::function_space::SerialFunctionSpace;
use bempp_element::element::create_element;
use bempp_grid::shapes::regular_sphere;
use bempp_tools::arrays::Array2D;
use bempp_traits::arrays::{AdjacencyListAccess, Array2DAccess};
use bempp_traits::bem::{DofMap, FunctionSpace};
use bempp_traits::cell::ReferenceCellType;
use bempp_traits::element::ElementFamily;
use bempp_traits::grid::{Geometry, Grid, Topology};

fn singular_kernel_dp0<'a>(
    result: &mut impl Array2DAccess<'a, f64>,
    test_vertices: &impl Array2DAccess<'a, f64>,
    trial_vertices: &impl Array2DAccess<'a, f64>,
    qid: usize,
) {
    #[rustfmt::skip]
    let test_points = match qid {
        // SAME TRIANGLE RULE
        0 => Array2D::from_data(vec![0.03522081090086451, 0.17610405450432262, 0.042663844023951264, 0.16666666666666669, 0.1741096997897534, 0.03721516561543372, 0.16666666666666669, 0.03522081090086453, 0.16666666666666669, 0.042663844023951264, 0.1761040545043226, 0.03522081090086453, 0.13144585576580214, 0.6572292788290107, 0.15922363354357993, 0.6220084679281462, 0.649786245705924, 0.1388888888888889, 0.6220084679281461, 0.13144585576580217, 0.6220084679281462, 0.15922363354357993, 0.6572292788290107, 0.13144585576580217, 0.03522081090086451, 0.17610405450432262, 0.037215165615433726, 0.16666666666666669, 0.16866102138123587, 0.042663844023951264, 0.16666666666666669, 0.03522081090086453, 0.16666666666666669, 0.03721516561543372, 0.1761040545043226, 0.03522081090086453, 0.13144585576580214, 0.6572292788290107, 0.13888888888888884, 0.6220084679281462, 0.6294515010512329, 0.15922363354357993, 0.6220084679281461, 0.13144585576580217, 0.6220084679281461, 0.1388888888888889, 0.6572292788290107, 0.13144585576580217, 0.009437387837655908, 0.20188747756753123, 0.037215165615433726, 0.16666666666666669, 0.19444444444444445, 0.016880420960742677, 0.16666666666666666, 0.009437387837655933, 0.16666666666666669, 0.03721516561543371, 0.2018874775675312, 0.009437387837655933, 0.035220810900864485, 0.7534543236939484, 0.13888888888888884, 0.6220084679281462, 0.7256765459161706, 0.0629985886786423, 0.6220084679281461, 0.03522081090086452, 0.6220084679281461, 0.1388888888888889, 0.7534543236939484, 0.03522081090086452, 0.009437387837655908, 0.20188747756753123, 0.01688042096074266, 0.16666666666666669, 0.1741096997897534, 0.03721516561543372, 0.16666666666666666, 0.009437387837655933, 0.16666666666666669, 0.016880420960742673, 0.2018874775675312, 0.009437387837655933, 0.035220810900864485, 0.7534543236939484, 0.06299858867864228, 0.6220084679281462, 0.649786245705924, 0.1388888888888889, 0.6220084679281461, 0.03522081090086452, 0.6220084679281462, 0.06299858867864229, 0.7534543236939484, 0.03522081090086452, 0.13144585576580214, 0.07987900963938499, 0.15922363354357996, 0.044658198738520456, 0.07243597651629827, 0.13888888888888887, 0.04465819873852045, 0.13144585576580214, 0.04465819873852048, 0.15922363354357993, 0.07987900963938499, 0.13144585576580214, 0.49056261216234404, 0.29811252243246883, 0.5942306901503684, 0.16666666666666669, 0.2703347446546911, 0.5183403899401218, 0.16666666666666663, 0.490562612162344, 0.16666666666666663, 0.5942306901503684, 0.2981125224324689, 0.490562612162344, 0.13144585576580214, 0.07987900963938499, 0.1388888888888889, 0.044658198738520456, 0.05210123186160723, 0.1592236335435799, 0.04465819873852045, 0.13144585576580214, 0.04465819873852045, 0.1388888888888889, 0.07987900963938499, 0.13144585576580214, 0.49056261216234404, 0.29811252243246883, 0.5183403899401218, 0.16666666666666669, 0.19444444444444453, 0.5942306901503683, 0.16666666666666663, 0.490562612162344, 0.16666666666666674, 0.5183403899401218, 0.2981125224324689, 0.490562612162344, 0.03522081090086451, 0.17610405450432262, 0.1388888888888889, 0.044658198738520456, 0.14832627672654486, 0.06299858867864229, 0.04465819873852046, 0.03522081090086451, 0.04465819873852045, 0.1388888888888889, 0.17610405450432262, 0.03522081090086451, 0.13144585576580214, 0.6572292788290107, 0.5183403899401218, 0.16666666666666669, 0.5535612008409864, 0.23511393375382647, 0.16666666666666666, 0.13144585576580212, 0.16666666666666674, 0.5183403899401218, 0.6572292788290107, 0.13144585576580212, 0.03522081090086451, 0.17610405450432262, 0.0629985886786423, 0.044658198738520456, 0.07243597651629824, 0.1388888888888889, 0.04465819873852046, 0.03522081090086451, 0.04465819873852046, 0.06299858867864229, 0.17610405450432262, 0.03522081090086451, 0.13144585576580214, 0.6572292788290107, 0.2351139337538265, 0.16666666666666669, 0.2703347446546911, 0.5183403899401218, 0.16666666666666666, 0.13144585576580212, 0.1666666666666667, 0.23511393375382647, 0.6572292788290107, 0.13144585576580212], (96, 2)),
        // EDGE ADJACENT RULES
        // qid => pairs
        //   1 => 0 0 1 1
        //   2 => 0 0 1 2
        2 => Array2D::from_data(vec![0.2018874775675312, 0.009437387837655933, 0.16666666666666669, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.2018874775675312, 0.007443033123086744, 0.16666666666666669, 0.042663844023951264, 0.7534543236939484, 0.03522081090086453, 0.6220084679281461, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.7534543236939484, 0.027777777777777783, 0.6220084679281462, 0.15922363354357993, 0.17610405450432262, 0.03522081090086452, 0.16666666666666669, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.20188747756753123, 0.0019943547145691905, 0.16666666666666669, 0.03721516561543372, 0.6572292788290107, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.7534543236939484, 0.007443033123086746, 0.6220084679281461, 0.1388888888888889, 0.2018874775675312, 0.009437387837655933, 0.16666666666666669, 0.044658198738520456, 0.16666666666666666, 0.009437387837655933, 0.17610405450432262, 0.02777777777777778, 0.16666666666666669, 0.03721516561543371, 0.7534543236939484, 0.03522081090086453, 0.6220084679281461, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.6572292788290107, 0.10366807798802437, 0.6220084679281461, 0.1388888888888889, 0.17610405450432262, 0.03522081090086452, 0.16666666666666669, 0.044658198738520456, 0.16666666666666666, 0.009437387837655933, 0.1761040545043226, 0.007443033123086741, 0.16666666666666669, 0.016880420960742673, 0.6572292788290107, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.6572292788290107, 0.027777777777777773, 0.6220084679281462, 0.06299858867864229, 0.1761040545043226, 0.03522081090086453, 0.04465819873852045, 0.16666666666666669, 0.04465819873852045, 0.13144585576580214, 0.17610405450432262, 0.02777777777777778, 0.04465819873852048, 0.15922363354357993, 0.6572292788290107, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.16666666666666663, 0.490562612162344, 0.6572292788290107, 0.10366807798802437, 0.16666666666666663, 0.5942306901503684, 0.07987900963938496, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.04465819873852045, 0.13144585576580214, 0.1761040545043226, 0.007443033123086741, 0.04465819873852045, 0.1388888888888889, 0.2981125224324688, 0.4905626121623441, 0.16666666666666663, 0.6220084679281462, 0.16666666666666663, 0.490562612162344, 0.6572292788290107, 0.027777777777777773, 0.16666666666666674, 0.5183403899401218, 0.1761040545043226, 0.03522081090086453, 0.04465819873852045, 0.16666666666666669, 0.04465819873852046, 0.03522081090086451, 0.07987900963938496, 0.10366807798802438, 0.04465819873852045, 0.1388888888888889, 0.6572292788290107, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.16666666666666666, 0.13144585576580212, 0.29811252243246883, 0.3868945341743197, 0.16666666666666674, 0.5183403899401218, 0.07987900963938496, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.04465819873852046, 0.03522081090086451, 0.07987900963938498, 0.02777777777777778, 0.04465819873852046, 0.06299858867864229, 0.2981125224324688, 0.4905626121623441, 0.16666666666666663, 0.6220084679281462, 0.16666666666666666, 0.13144585576580212, 0.29811252243246883, 0.10366807798802437, 0.1666666666666667, 0.23511393375382647, ], (80, 2)),
        //   3 => 0 1 1 0
        //   4 => 0 1 1 2
        //   5 => 0 2 1 0
        //   6 => 0 2 1 1
        6 => Array2D::from_data(vec![0.2018874775675312, 0.009437387837655933, 0.16666666666666669, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.2018874775675312, 0.007443033123086744, 0.16666666666666669, 0.042663844023951264, 0.7534543236939484, 0.03522081090086453, 0.6220084679281461, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.7534543236939484, 0.027777777777777783, 0.6220084679281462, 0.15922363354357993, 0.17610405450432262, 0.03522081090086452, 0.16666666666666669, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.20188747756753123, 0.0019943547145691905, 0.16666666666666669, 0.03721516561543372, 0.6572292788290107, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.7534543236939484, 0.007443033123086746, 0.6220084679281461, 0.1388888888888889, 0.2018874775675312, 0.009437387837655933, 0.16666666666666669, 0.044658198738520456, 0.16666666666666666, 0.009437387837655933, 0.17610405450432262, 0.02777777777777778, 0.16666666666666669, 0.03721516561543371, 0.7534543236939484, 0.03522081090086453, 0.6220084679281461, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.6572292788290107, 0.10366807798802437, 0.6220084679281461, 0.1388888888888889, 0.17610405450432262, 0.03522081090086452, 0.16666666666666669, 0.044658198738520456, 0.16666666666666666, 0.009437387837655933, 0.1761040545043226, 0.007443033123086741, 0.16666666666666669, 0.016880420960742673, 0.6572292788290107, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.6572292788290107, 0.027777777777777773, 0.6220084679281462, 0.06299858867864229, 0.1761040545043226, 0.03522081090086453, 0.04465819873852045, 0.16666666666666669, 0.04465819873852045, 0.13144585576580214, 0.17610405450432262, 0.02777777777777778, 0.04465819873852048, 0.15922363354357993, 0.6572292788290107, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.16666666666666663, 0.490562612162344, 0.6572292788290107, 0.10366807798802437, 0.16666666666666663, 0.5942306901503684, 0.07987900963938496, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.04465819873852045, 0.13144585576580214, 0.1761040545043226, 0.007443033123086741, 0.04465819873852045, 0.1388888888888889, 0.2981125224324688, 0.4905626121623441, 0.16666666666666663, 0.6220084679281462, 0.16666666666666663, 0.490562612162344, 0.6572292788290107, 0.027777777777777773, 0.16666666666666674, 0.5183403899401218, 0.1761040545043226, 0.03522081090086453, 0.04465819873852045, 0.16666666666666669, 0.04465819873852046, 0.03522081090086451, 0.07987900963938496, 0.10366807798802438, 0.04465819873852045, 0.1388888888888889, 0.6572292788290107, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.16666666666666666, 0.13144585576580212, 0.29811252243246883, 0.3868945341743197, 0.16666666666666674, 0.5183403899401218, 0.07987900963938496, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.04465819873852046, 0.03522081090086451, 0.07987900963938498, 0.02777777777777778, 0.04465819873852046, 0.06299858867864229, 0.2981125224324688, 0.4905626121623441, 0.16666666666666663, 0.6220084679281462, 0.16666666666666666, 0.13144585576580212, 0.29811252243246883, 0.10366807798802437, 0.1666666666666667, 0.23511393375382647], (80, 2)),
        //   7 => 0 0 2 1
        7 => Array2D::from_data(vec![0.009437387837655933, 0.2018874775675312, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.16666666666666669, 0.007443033123086744, 0.2018874775675312, 0.042663844023951264, 0.16666666666666669, 0.03522081090086453, 0.7534543236939484, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.6220084679281461, 0.027777777777777783, 0.7534543236939484, 0.15922363354357993, 0.6220084679281462, 0.03522081090086452, 0.17610405450432262, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.16666666666666669, 0.0019943547145691905, 0.20188747756753123, 0.03721516561543372, 0.16666666666666669, 0.13144585576580217, 0.6572292788290107, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.6220084679281461, 0.007443033123086746, 0.7534543236939484, 0.1388888888888889, 0.6220084679281461, 0.009437387837655933, 0.2018874775675312, 0.044658198738520456, 0.16666666666666669, 0.009437387837655933, 0.16666666666666666, 0.02777777777777778, 0.17610405450432262, 0.03721516561543371, 0.16666666666666669, 0.03522081090086453, 0.7534543236939484, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.6220084679281461, 0.10366807798802437, 0.6572292788290107, 0.1388888888888889, 0.6220084679281461, 0.03522081090086452, 0.17610405450432262, 0.044658198738520456, 0.16666666666666669, 0.009437387837655933, 0.16666666666666666, 0.007443033123086741, 0.1761040545043226, 0.016880420960742673, 0.16666666666666669, 0.13144585576580217, 0.6572292788290107, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.6220084679281461, 0.027777777777777773, 0.6572292788290107, 0.06299858867864229, 0.6220084679281462, 0.03522081090086453, 0.1761040545043226, 0.16666666666666669, 0.04465819873852045, 0.13144585576580214, 0.04465819873852045, 0.02777777777777778, 0.17610405450432262, 0.15922363354357993, 0.04465819873852048, 0.13144585576580217, 0.6572292788290107, 0.6220084679281462, 0.16666666666666663, 0.490562612162344, 0.16666666666666663, 0.10366807798802437, 0.6572292788290107, 0.5942306901503684, 0.16666666666666663, 0.13144585576580217, 0.07987900963938496, 0.16666666666666669, 0.04465819873852045, 0.13144585576580214, 0.04465819873852045, 0.007443033123086741, 0.1761040545043226, 0.1388888888888889, 0.04465819873852045, 0.4905626121623441, 0.2981125224324688, 0.6220084679281462, 0.16666666666666663, 0.490562612162344, 0.16666666666666663, 0.027777777777777773, 0.6572292788290107, 0.5183403899401218, 0.16666666666666674, 0.03522081090086453, 0.1761040545043226, 0.16666666666666669, 0.04465819873852045, 0.03522081090086451, 0.04465819873852046, 0.10366807798802438, 0.07987900963938496, 0.1388888888888889, 0.04465819873852045, 0.13144585576580217, 0.6572292788290107, 0.6220084679281462, 0.16666666666666663, 0.13144585576580212, 0.16666666666666666, 0.3868945341743197, 0.29811252243246883, 0.5183403899401218, 0.16666666666666674, 0.13144585576580217, 0.07987900963938496, 0.16666666666666669, 0.04465819873852045, 0.03522081090086451, 0.04465819873852046, 0.02777777777777778, 0.07987900963938498, 0.06299858867864229, 0.04465819873852046, 0.4905626121623441, 0.2981125224324688, 0.6220084679281462, 0.16666666666666663, 0.13144585576580212, 0.16666666666666666, 0.10366807798802437, 0.29811252243246883, 0.23511393375382647, 0.1666666666666667, ], (80, 2)),
        //   8 => 0 0 2 2
        //   9 => 0 1 2 0
        //  10 => 0 1 2 2
        10 => Array2D::from_data(vec![0.009437387837655933, 0.2018874775675312, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.16666666666666669, 0.007443033123086744, 0.2018874775675312, 0.042663844023951264, 0.16666666666666669, 0.03522081090086453, 0.7534543236939484, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.6220084679281461, 0.027777777777777783, 0.7534543236939484, 0.15922363354357993, 0.6220084679281462, 0.03522081090086452, 0.17610405450432262, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.16666666666666669, 0.0019943547145691905, 0.20188747756753123, 0.03721516561543372, 0.16666666666666669, 0.13144585576580217, 0.6572292788290107, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.6220084679281461, 0.007443033123086746, 0.7534543236939484, 0.1388888888888889, 0.6220084679281461, 0.009437387837655933, 0.2018874775675312, 0.044658198738520456, 0.16666666666666669, 0.009437387837655933, 0.16666666666666666, 0.02777777777777778, 0.17610405450432262, 0.03721516561543371, 0.16666666666666669, 0.03522081090086453, 0.7534543236939484, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.6220084679281461, 0.10366807798802437, 0.6572292788290107, 0.1388888888888889, 0.6220084679281461, 0.03522081090086452, 0.17610405450432262, 0.044658198738520456, 0.16666666666666669, 0.009437387837655933, 0.16666666666666666, 0.007443033123086741, 0.1761040545043226, 0.016880420960742673, 0.16666666666666669, 0.13144585576580217, 0.6572292788290107, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.6220084679281461, 0.027777777777777773, 0.6572292788290107, 0.06299858867864229, 0.6220084679281462, 0.03522081090086453, 0.1761040545043226, 0.16666666666666669, 0.04465819873852045, 0.13144585576580214, 0.04465819873852045, 0.02777777777777778, 0.17610405450432262, 0.15922363354357993, 0.04465819873852048, 0.13144585576580217, 0.6572292788290107, 0.6220084679281462, 0.16666666666666663, 0.490562612162344, 0.16666666666666663, 0.10366807798802437, 0.6572292788290107, 0.5942306901503684, 0.16666666666666663, 0.13144585576580217, 0.07987900963938496, 0.16666666666666669, 0.04465819873852045, 0.13144585576580214, 0.04465819873852045, 0.007443033123086741, 0.1761040545043226, 0.1388888888888889, 0.04465819873852045, 0.4905626121623441, 0.2981125224324688, 0.6220084679281462, 0.16666666666666663, 0.490562612162344, 0.16666666666666663, 0.027777777777777773, 0.6572292788290107, 0.5183403899401218, 0.16666666666666674, 0.03522081090086453, 0.1761040545043226, 0.16666666666666669, 0.04465819873852045, 0.03522081090086451, 0.04465819873852046, 0.10366807798802438, 0.07987900963938496, 0.1388888888888889, 0.04465819873852045, 0.13144585576580217, 0.6572292788290107, 0.6220084679281462, 0.16666666666666663, 0.13144585576580212, 0.16666666666666666, 0.3868945341743197, 0.29811252243246883, 0.5183403899401218, 0.16666666666666674, 0.13144585576580217, 0.07987900963938496, 0.16666666666666669, 0.04465819873852045, 0.03522081090086451, 0.04465819873852046, 0.02777777777777778, 0.07987900963938498, 0.06299858867864229, 0.04465819873852046, 0.4905626121623441, 0.2981125224324688, 0.6220084679281462, 0.16666666666666663, 0.13144585576580212, 0.16666666666666666, 0.10366807798802437, 0.29811252243246883, 0.23511393375382647, 0.1666666666666667, ], (80, 2)),
        //  11 => 0 2 2 0
        //  12 => 0 2 2 1
        //  13 => 1 0 2 1
        //  14 => 1 0 2 2
        14 => Array2D::from_data(vec![0.7886751345948129, 0.2018874775675312, 0.7886751345948129, 0.16666666666666669, 0.7981125224324688, 0.16666666666666669, 0.7906694893093821, 0.2018874775675312, 0.7906694893093821, 0.16666666666666669, 0.21132486540518713, 0.7534543236939484, 0.21132486540518713, 0.6220084679281461, 0.24654567630605173, 0.6220084679281461, 0.21876789852827383, 0.7534543236939484, 0.21876789852827383, 0.6220084679281462, 0.7886751345948129, 0.17610405450432262, 0.7886751345948129, 0.16666666666666669, 0.7981125224324688, 0.16666666666666669, 0.7961181677178996, 0.20188747756753123, 0.7961181677178996, 0.16666666666666669, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.6220084679281461, 0.24654567630605173, 0.6220084679281461, 0.23910264318296492, 0.7534543236939484, 0.23910264318296492, 0.6220084679281461, 0.7886751345948129, 0.2018874775675312, 0.7886751345948129, 0.16666666666666669, 0.8238959454956774, 0.16666666666666666, 0.7961181677178996, 0.17610405450432262, 0.7961181677178996, 0.16666666666666669, 0.21132486540518713, 0.7534543236939484, 0.21132486540518713, 0.6220084679281461, 0.3427707211709894, 0.6220084679281461, 0.23910264318296492, 0.6572292788290107, 0.23910264318296492, 0.6220084679281461, 0.7886751345948129, 0.17610405450432262, 0.7886751345948129, 0.16666666666666669, 0.8238959454956774, 0.16666666666666666, 0.8164529123725907, 0.1761040545043226, 0.8164529123725907, 0.16666666666666669, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.6220084679281461, 0.3427707211709894, 0.6220084679281461, 0.3149929433932115, 0.6572292788290107, 0.3149929433932115, 0.6220084679281462, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.04465819873852045, 0.8238959454956774, 0.04465819873852045, 0.7961181677178996, 0.17610405450432262, 0.7961181677178996, 0.04465819873852048, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.16666666666666663, 0.3427707211709894, 0.16666666666666663, 0.23910264318296492, 0.6572292788290107, 0.23910264318296492, 0.16666666666666663, 0.7886751345948129, 0.07987900963938496, 0.7886751345948129, 0.04465819873852045, 0.8238959454956774, 0.04465819873852045, 0.8164529123725907, 0.1761040545043226, 0.8164529123725907, 0.04465819873852045, 0.21132486540518713, 0.2981125224324688, 0.21132486540518713, 0.16666666666666663, 0.3427707211709894, 0.16666666666666663, 0.3149929433932115, 0.6572292788290107, 0.3149929433932115, 0.16666666666666674, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.04465819873852045, 0.920120990360615, 0.04465819873852046, 0.8164529123725907, 0.07987900963938496, 0.8164529123725907, 0.04465819873852045, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.16666666666666663, 0.7018874775675312, 0.16666666666666666, 0.3149929433932115, 0.29811252243246883, 0.3149929433932115, 0.16666666666666674, 0.7886751345948129, 0.07987900963938496, 0.7886751345948129, 0.04465819873852045, 0.920120990360615, 0.04465819873852046, 0.8923432125828372, 0.07987900963938498, 0.8923432125828372, 0.04465819873852046, 0.21132486540518713, 0.2981125224324688, 0.21132486540518713, 0.16666666666666663, 0.7018874775675312, 0.16666666666666666, 0.5982193995795069, 0.29811252243246883, 0.5982193995795069, 0.1666666666666667, ], (80, 2)),
        //  15 => 1 1 2 0
        15 => Array2D::from_data(vec![0.7886751345948129, 0.2018874775675312, 0.7886751345948129, 0.16666666666666669, 0.7981125224324688, 0.16666666666666669, 0.7906694893093821, 0.2018874775675312, 0.7906694893093821, 0.16666666666666669, 0.21132486540518713, 0.7534543236939484, 0.21132486540518713, 0.6220084679281461, 0.24654567630605173, 0.6220084679281461, 0.21876789852827383, 0.7534543236939484, 0.21876789852827383, 0.6220084679281462, 0.7886751345948129, 0.17610405450432262, 0.7886751345948129, 0.16666666666666669, 0.7981125224324688, 0.16666666666666669, 0.7961181677178996, 0.20188747756753123, 0.7961181677178996, 0.16666666666666669, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.6220084679281461, 0.24654567630605173, 0.6220084679281461, 0.23910264318296492, 0.7534543236939484, 0.23910264318296492, 0.6220084679281461, 0.7886751345948129, 0.2018874775675312, 0.7886751345948129, 0.16666666666666669, 0.8238959454956774, 0.16666666666666666, 0.7961181677178996, 0.17610405450432262, 0.7961181677178996, 0.16666666666666669, 0.21132486540518713, 0.7534543236939484, 0.21132486540518713, 0.6220084679281461, 0.3427707211709894, 0.6220084679281461, 0.23910264318296492, 0.6572292788290107, 0.23910264318296492, 0.6220084679281461, 0.7886751345948129, 0.17610405450432262, 0.7886751345948129, 0.16666666666666669, 0.8238959454956774, 0.16666666666666666, 0.8164529123725907, 0.1761040545043226, 0.8164529123725907, 0.16666666666666669, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.6220084679281461, 0.3427707211709894, 0.6220084679281461, 0.3149929433932115, 0.6572292788290107, 0.3149929433932115, 0.6220084679281462, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.04465819873852045, 0.8238959454956774, 0.04465819873852045, 0.7961181677178996, 0.17610405450432262, 0.7961181677178996, 0.04465819873852048, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.16666666666666663, 0.3427707211709894, 0.16666666666666663, 0.23910264318296492, 0.6572292788290107, 0.23910264318296492, 0.16666666666666663, 0.7886751345948129, 0.07987900963938496, 0.7886751345948129, 0.04465819873852045, 0.8238959454956774, 0.04465819873852045, 0.8164529123725907, 0.1761040545043226, 0.8164529123725907, 0.04465819873852045, 0.21132486540518713, 0.2981125224324688, 0.21132486540518713, 0.16666666666666663, 0.3427707211709894, 0.16666666666666663, 0.3149929433932115, 0.6572292788290107, 0.3149929433932115, 0.16666666666666674, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.04465819873852045, 0.920120990360615, 0.04465819873852046, 0.8164529123725907, 0.07987900963938496, 0.8164529123725907, 0.04465819873852045, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.16666666666666663, 0.7018874775675312, 0.16666666666666666, 0.3149929433932115, 0.29811252243246883, 0.3149929433932115, 0.16666666666666674, 0.7886751345948129, 0.07987900963938496, 0.7886751345948129, 0.04465819873852045, 0.920120990360615, 0.04465819873852046, 0.8923432125828372, 0.07987900963938498, 0.8923432125828372, 0.04465819873852046, 0.21132486540518713, 0.2981125224324688, 0.21132486540518713, 0.16666666666666663, 0.7018874775675312, 0.16666666666666666, 0.5982193995795069, 0.29811252243246883, 0.5982193995795069, 0.1666666666666667, ], (80, 2)),
        //  16 => 1 1 2 2
        //  17 => 1 2 2 0
        //  18 => 1 2 2 1
        18 => Array2D::from_data(vec![0.7886751345948129, 0.2018874775675312, 0.7886751345948129, 0.16666666666666669, 0.7981125224324688, 0.16666666666666669, 0.7906694893093821, 0.2018874775675312, 0.7906694893093821, 0.16666666666666669, 0.21132486540518713, 0.7534543236939484, 0.21132486540518713, 0.6220084679281461, 0.24654567630605173, 0.6220084679281461, 0.21876789852827383, 0.7534543236939484, 0.21876789852827383, 0.6220084679281462, 0.7886751345948129, 0.17610405450432262, 0.7886751345948129, 0.16666666666666669, 0.7981125224324688, 0.16666666666666669, 0.7961181677178996, 0.20188747756753123, 0.7961181677178996, 0.16666666666666669, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.6220084679281461, 0.24654567630605173, 0.6220084679281461, 0.23910264318296492, 0.7534543236939484, 0.23910264318296492, 0.6220084679281461, 0.7886751345948129, 0.2018874775675312, 0.7886751345948129, 0.16666666666666669, 0.8238959454956774, 0.16666666666666666, 0.7961181677178996, 0.17610405450432262, 0.7961181677178996, 0.16666666666666669, 0.21132486540518713, 0.7534543236939484, 0.21132486540518713, 0.6220084679281461, 0.3427707211709894, 0.6220084679281461, 0.23910264318296492, 0.6572292788290107, 0.23910264318296492, 0.6220084679281461, 0.7886751345948129, 0.17610405450432262, 0.7886751345948129, 0.16666666666666669, 0.8238959454956774, 0.16666666666666666, 0.8164529123725907, 0.1761040545043226, 0.8164529123725907, 0.16666666666666669, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.6220084679281461, 0.3427707211709894, 0.6220084679281461, 0.3149929433932115, 0.6572292788290107, 0.3149929433932115, 0.6220084679281462, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.04465819873852045, 0.8238959454956774, 0.04465819873852045, 0.7961181677178996, 0.17610405450432262, 0.7961181677178996, 0.04465819873852048, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.16666666666666663, 0.3427707211709894, 0.16666666666666663, 0.23910264318296492, 0.6572292788290107, 0.23910264318296492, 0.16666666666666663, 0.7886751345948129, 0.07987900963938496, 0.7886751345948129, 0.04465819873852045, 0.8238959454956774, 0.04465819873852045, 0.8164529123725907, 0.1761040545043226, 0.8164529123725907, 0.04465819873852045, 0.21132486540518713, 0.2981125224324688, 0.21132486540518713, 0.16666666666666663, 0.3427707211709894, 0.16666666666666663, 0.3149929433932115, 0.6572292788290107, 0.3149929433932115, 0.16666666666666674, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.04465819873852045, 0.920120990360615, 0.04465819873852046, 0.8164529123725907, 0.07987900963938496, 0.8164529123725907, 0.04465819873852045, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.16666666666666663, 0.7018874775675312, 0.16666666666666666, 0.3149929433932115, 0.29811252243246883, 0.3149929433932115, 0.16666666666666674, 0.7886751345948129, 0.07987900963938496, 0.7886751345948129, 0.04465819873852045, 0.920120990360615, 0.04465819873852046, 0.8923432125828372, 0.07987900963938498, 0.8923432125828372, 0.04465819873852046, 0.21132486540518713, 0.2981125224324688, 0.21132486540518713, 0.16666666666666663, 0.7018874775675312, 0.16666666666666666, 0.5982193995795069, 0.29811252243246883, 0.5982193995795069, 0.1666666666666667, ], (80, 2)),

        // VERTEX ADJACENT RULES
        // qid => pairs
        //  19 => 0 0
        19 => Array2D::from_data(vec![0.16666666666666669, 0.044658198738520456, 0.03522081090086453, 0.009437387837655933, 0.6220084679281461, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666669, 0.044658198738520456, 0.009437387837655936, 0.03522081090086452, 0.6220084679281461, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666669, 0.044658198738520456, 0.13144585576580214, 0.03522081090086453, 0.6220084679281461, 0.16666666666666669, 0.4905626121623441, 0.13144585576580217, 0.16666666666666669, 0.044658198738520456, 0.03522081090086451, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.13144585576580214, 0.4905626121623441, 0.04465819873852045, 0.16666666666666669, 0.03522081090086453, 0.009437387837655933, 0.16666666666666663, 0.6220084679281462, 0.13144585576580214, 0.03522081090086453, 0.04465819873852045, 0.16666666666666669, 0.009437387837655936, 0.03522081090086452, 0.16666666666666663, 0.6220084679281462, 0.03522081090086451, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666663, 0.6220084679281462, 0.4905626121623441, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.13144585576580214, 0.4905626121623441, ], (32, 2)),
        //  20 => 0 1
        20 => Array2D::from_data(vec![0.16666666666666669, 0.044658198738520456, 0.03522081090086453, 0.009437387837655933, 0.6220084679281461, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666669, 0.044658198738520456, 0.009437387837655936, 0.03522081090086452, 0.6220084679281461, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666669, 0.044658198738520456, 0.13144585576580214, 0.03522081090086453, 0.6220084679281461, 0.16666666666666669, 0.4905626121623441, 0.13144585576580217, 0.16666666666666669, 0.044658198738520456, 0.03522081090086451, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.13144585576580214, 0.4905626121623441, 0.04465819873852045, 0.16666666666666669, 0.03522081090086453, 0.009437387837655933, 0.16666666666666663, 0.6220084679281462, 0.13144585576580214, 0.03522081090086453, 0.04465819873852045, 0.16666666666666669, 0.009437387837655936, 0.03522081090086452, 0.16666666666666663, 0.6220084679281462, 0.03522081090086451, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666663, 0.6220084679281462, 0.4905626121623441, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.13144585576580214, 0.4905626121623441, ], (32, 2)),
        //  21 => 0 2
        21 => Array2D::from_data(vec![0.16666666666666669, 0.044658198738520456, 0.03522081090086453, 0.009437387837655933, 0.6220084679281461, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666669, 0.044658198738520456, 0.009437387837655936, 0.03522081090086452, 0.6220084679281461, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666669, 0.044658198738520456, 0.13144585576580214, 0.03522081090086453, 0.6220084679281461, 0.16666666666666669, 0.4905626121623441, 0.13144585576580217, 0.16666666666666669, 0.044658198738520456, 0.03522081090086451, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.13144585576580214, 0.4905626121623441, 0.04465819873852045, 0.16666666666666669, 0.03522081090086453, 0.009437387837655933, 0.16666666666666663, 0.6220084679281462, 0.13144585576580214, 0.03522081090086453, 0.04465819873852045, 0.16666666666666669, 0.009437387837655936, 0.03522081090086452, 0.16666666666666663, 0.6220084679281462, 0.03522081090086451, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666663, 0.6220084679281462, 0.4905626121623441, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.13144585576580214, 0.4905626121623441, ], (32, 2)),
        //  22 => 1 0
        22 => Array2D::from_data(vec![0.7886751345948129, 0.16666666666666669, 0.9553418012614795, 0.03522081090086453, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.16666666666666669, 0.9553418012614795, 0.009437387837655936, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.6220084679281461, 0.37799153207185376, 0.4905626121623441, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.6220084679281461, 0.37799153207185376, 0.13144585576580214, 0.7886751345948129, 0.04465819873852045, 0.9553418012614795, 0.03522081090086453, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.04465819873852045, 0.9553418012614795, 0.009437387837655936, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.16666666666666663, 0.37799153207185376, 0.4905626121623441, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.16666666666666663, 0.37799153207185376, 0.13144585576580214, ], (32, 2)),
        //  23 => 1 1
        23 => Array2D::from_data(vec![0.7886751345948129, 0.16666666666666669, 0.9553418012614795, 0.03522081090086453, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.16666666666666669, 0.9553418012614795, 0.009437387837655936, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.6220084679281461, 0.37799153207185376, 0.4905626121623441, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.6220084679281461, 0.37799153207185376, 0.13144585576580214, 0.7886751345948129, 0.04465819873852045, 0.9553418012614795, 0.03522081090086453, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.04465819873852045, 0.9553418012614795, 0.009437387837655936, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.16666666666666663, 0.37799153207185376, 0.4905626121623441, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.16666666666666663, 0.37799153207185376, 0.13144585576580214, ], (32, 2)),
        //  24 => 1 2
        24 => Array2D::from_data(vec![0.7886751345948129, 0.16666666666666669, 0.9553418012614795, 0.03522081090086453, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.16666666666666669, 0.9553418012614795, 0.009437387837655936, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.6220084679281461, 0.37799153207185376, 0.4905626121623441, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.6220084679281461, 0.37799153207185376, 0.13144585576580214, 0.7886751345948129, 0.04465819873852045, 0.9553418012614795, 0.03522081090086453, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.04465819873852045, 0.9553418012614795, 0.009437387837655936, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.16666666666666663, 0.37799153207185376, 0.4905626121623441, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.16666666666666663, 0.37799153207185376, 0.13144585576580214, ], (32, 2)),
        //  25 => 2 0
        25 => Array2D::from_data(vec![0.044658198738520456, 0.7886751345948129, 0.009437387837655933, 0.9553418012614795, 0.16666666666666669, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.03522081090086452, 0.9553418012614795, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.37799153207185376, 0.044658198738520456, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.4905626121623441, 0.37799153207185376, 0.16666666666666669, 0.7886751345948129, 0.009437387837655933, 0.9553418012614795, 0.6220084679281462, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.03522081090086452, 0.9553418012614795, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.37799153207185376, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.4905626121623441, 0.37799153207185376, ], (32, 2)),
        //  26 => 2 1
        26 => Array2D::from_data(vec![0.044658198738520456, 0.7886751345948129, 0.009437387837655933, 0.9553418012614795, 0.16666666666666669, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.03522081090086452, 0.9553418012614795, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.37799153207185376, 0.044658198738520456, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.4905626121623441, 0.37799153207185376, 0.16666666666666669, 0.7886751345948129, 0.009437387837655933, 0.9553418012614795, 0.6220084679281462, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.03522081090086452, 0.9553418012614795, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.37799153207185376, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.4905626121623441, 0.37799153207185376, ], (32, 2)),
        //  27 => 2 2
        27 => Array2D::from_data(vec![0.044658198738520456, 0.7886751345948129, 0.009437387837655933, 0.9553418012614795, 0.16666666666666669, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.03522081090086452, 0.9553418012614795, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.37799153207185376, 0.044658198738520456, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.4905626121623441, 0.37799153207185376, 0.16666666666666669, 0.7886751345948129, 0.009437387837655933, 0.9553418012614795, 0.6220084679281462, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.03522081090086452, 0.9553418012614795, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.37799153207185376, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.4905626121623441, 0.37799153207185376, ], (32, 2)),

        _ => { panic!("Invalid quadrature requested:"); }
    };
    #[rustfmt::skip]
    let trial_points = match qid {
        0 => Array2D::from_data(vec![0.042663844023951264, 0.16666666666666669, 0.03522081090086451, 0.17610405450432262, 0.16666666666666669, 0.03522081090086453, 0.1741096997897534, 0.03721516561543372, 0.1761040545043226, 0.03522081090086453, 0.16666666666666669, 0.042663844023951264, 0.15922363354357993, 0.6220084679281462, 0.13144585576580214, 0.6572292788290107, 0.6220084679281461, 0.13144585576580217, 0.649786245705924, 0.1388888888888889, 0.6572292788290107, 0.13144585576580217, 0.6220084679281462, 0.15922363354357993, 0.037215165615433726, 0.16666666666666669, 0.03522081090086451, 0.17610405450432262, 0.16666666666666669, 0.03522081090086453, 0.16866102138123587, 0.042663844023951264, 0.1761040545043226, 0.03522081090086453, 0.16666666666666669, 0.03721516561543372, 0.13888888888888884, 0.6220084679281462, 0.13144585576580214, 0.6572292788290107, 0.6220084679281461, 0.13144585576580217, 0.6294515010512329, 0.15922363354357993, 0.6572292788290107, 0.13144585576580217, 0.6220084679281461, 0.1388888888888889, 0.037215165615433726, 0.16666666666666669, 0.009437387837655908, 0.20188747756753123, 0.16666666666666666, 0.009437387837655933, 0.19444444444444445, 0.016880420960742677, 0.2018874775675312, 0.009437387837655933, 0.16666666666666669, 0.03721516561543371, 0.13888888888888884, 0.6220084679281462, 0.035220810900864485, 0.7534543236939484, 0.6220084679281461, 0.03522081090086452, 0.7256765459161706, 0.0629985886786423, 0.7534543236939484, 0.03522081090086452, 0.6220084679281461, 0.1388888888888889, 0.01688042096074266, 0.16666666666666669, 0.009437387837655908, 0.20188747756753123, 0.16666666666666666, 0.009437387837655933, 0.1741096997897534, 0.03721516561543372, 0.2018874775675312, 0.009437387837655933, 0.16666666666666669, 0.016880420960742673, 0.06299858867864228, 0.6220084679281462, 0.035220810900864485, 0.7534543236939484, 0.6220084679281461, 0.03522081090086452, 0.649786245705924, 0.1388888888888889, 0.7534543236939484, 0.03522081090086452, 0.6220084679281462, 0.06299858867864229, 0.15922363354357996, 0.044658198738520456, 0.13144585576580214, 0.07987900963938499, 0.04465819873852045, 0.13144585576580214, 0.07243597651629827, 0.13888888888888887, 0.07987900963938499, 0.13144585576580214, 0.04465819873852048, 0.15922363354357993, 0.5942306901503684, 0.16666666666666669, 0.49056261216234404, 0.29811252243246883, 0.16666666666666663, 0.490562612162344, 0.2703347446546911, 0.5183403899401218, 0.2981125224324689, 0.490562612162344, 0.16666666666666663, 0.5942306901503684, 0.1388888888888889, 0.044658198738520456, 0.13144585576580214, 0.07987900963938499, 0.04465819873852045, 0.13144585576580214, 0.05210123186160723, 0.1592236335435799, 0.07987900963938499, 0.13144585576580214, 0.04465819873852045, 0.1388888888888889, 0.5183403899401218, 0.16666666666666669, 0.49056261216234404, 0.29811252243246883, 0.16666666666666663, 0.490562612162344, 0.19444444444444453, 0.5942306901503683, 0.2981125224324689, 0.490562612162344, 0.16666666666666674, 0.5183403899401218, 0.1388888888888889, 0.044658198738520456, 0.03522081090086451, 0.17610405450432262, 0.04465819873852046, 0.03522081090086451, 0.14832627672654486, 0.06299858867864229, 0.17610405450432262, 0.03522081090086451, 0.04465819873852045, 0.1388888888888889, 0.5183403899401218, 0.16666666666666669, 0.13144585576580214, 0.6572292788290107, 0.16666666666666666, 0.13144585576580212, 0.5535612008409864, 0.23511393375382647, 0.6572292788290107, 0.13144585576580212, 0.16666666666666674, 0.5183403899401218, 0.0629985886786423, 0.044658198738520456, 0.03522081090086451, 0.17610405450432262, 0.04465819873852046, 0.03522081090086451, 0.07243597651629824, 0.1388888888888889, 0.17610405450432262, 0.03522081090086451, 0.04465819873852046, 0.06299858867864229, 0.2351139337538265, 0.16666666666666669, 0.13144585576580214, 0.6572292788290107, 0.16666666666666666, 0.13144585576580212, 0.2703347446546911, 0.5183403899401218, 0.6572292788290107, 0.13144585576580212, 0.1666666666666667, 0.23511393375382647], (96, 2)),
        2 => Array2D::from_data(vec![0.03522081090086453, 0.16666666666666669, 0.007443033123086744, 0.2018874775675312, 0.00199435471456919, 0.20933051069061795, 0.044658198738520456, 0.16666666666666669, 0.009437387837655933, 0.2018874775675312, 0.13144585576580217, 0.6220084679281461, 0.027777777777777783, 0.7534543236939484, 0.007443033123086743, 0.7812321014717262, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.7534543236939484, 0.03522081090086453, 0.16666666666666669, 0.0019943547145691905, 0.20188747756753123, 0.007443033123086742, 0.20388183228210038, 0.044658198738520456, 0.16666666666666669, 0.009437387837655933, 0.2018874775675312, 0.13144585576580217, 0.6220084679281461, 0.007443033123086746, 0.7534543236939484, 0.027777777777777776, 0.7608973568170351, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.7534543236939484, 0.009437387837655933, 0.16666666666666666, 0.02777777777777778, 0.17610405450432262, 0.007443033123086744, 0.20388183228210038, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.1761040545043226, 0.03522081090086452, 0.6220084679281461, 0.10366807798802437, 0.6572292788290107, 0.027777777777777783, 0.7608973568170351, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.6572292788290107, 0.009437387837655933, 0.16666666666666666, 0.007443033123086741, 0.1761040545043226, 0.027777777777777787, 0.18354708762740934, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.1761040545043226, 0.03522081090086452, 0.6220084679281461, 0.027777777777777773, 0.6572292788290107, 0.10366807798802438, 0.6850070566067885, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.6572292788290107, 0.13144585576580214, 0.04465819873852045, 0.02777777777777778, 0.17610405450432262, 0.007443033123086744, 0.20388183228210038, 0.16666666666666669, 0.04465819873852045, 0.03522081090086453, 0.1761040545043226, 0.490562612162344, 0.16666666666666663, 0.10366807798802437, 0.6572292788290107, 0.027777777777777783, 0.7608973568170351, 0.6220084679281462, 0.16666666666666663, 0.13144585576580217, 0.6572292788290107, 0.13144585576580214, 0.04465819873852045, 0.007443033123086741, 0.1761040545043226, 0.027777777777777787, 0.18354708762740934, 0.16666666666666669, 0.04465819873852045, 0.03522081090086453, 0.1761040545043226, 0.490562612162344, 0.16666666666666663, 0.027777777777777773, 0.6572292788290107, 0.10366807798802438, 0.6850070566067885, 0.6220084679281462, 0.16666666666666663, 0.13144585576580217, 0.6572292788290107, 0.03522081090086451, 0.04465819873852046, 0.10366807798802438, 0.07987900963938496, 0.027777777777777787, 0.18354708762740934, 0.16666666666666669, 0.04465819873852045, 0.13144585576580217, 0.07987900963938496, 0.13144585576580212, 0.16666666666666666, 0.3868945341743197, 0.29811252243246883, 0.10366807798802438, 0.6850070566067885, 0.6220084679281462, 0.16666666666666663, 0.4905626121623441, 0.2981125224324688, 0.03522081090086451, 0.04465819873852046, 0.02777777777777778, 0.07987900963938498, 0.10366807798802438, 0.10765678741716275, 0.16666666666666669, 0.04465819873852045, 0.13144585576580217, 0.07987900963938496, 0.13144585576580212, 0.16666666666666666, 0.10366807798802437, 0.29811252243246883, 0.3868945341743197, 0.4017806004204932, 0.6220084679281462, 0.16666666666666663, 0.4905626121623441, 0.2981125224324688, ], (80, 2)),
        6 => Array2D::from_data(vec![0.16666666666666669, 0.7981125224324688, 0.2018874775675312, 0.7906694893093821, 0.20933051069061795, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.2018874775675312, 0.7886751345948129, 0.6220084679281461, 0.24654567630605173, 0.7534543236939484, 0.21876789852827383, 0.7812321014717262, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.7534543236939484, 0.21132486540518713, 0.16666666666666669, 0.7981125224324688, 0.20188747756753123, 0.7961181677178996, 0.20388183228210038, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.2018874775675312, 0.7886751345948129, 0.6220084679281461, 0.24654567630605173, 0.7534543236939484, 0.23910264318296492, 0.7608973568170351, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.7534543236939484, 0.21132486540518713, 0.16666666666666666, 0.8238959454956774, 0.17610405450432262, 0.7961181677178996, 0.20388183228210038, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.6220084679281461, 0.3427707211709894, 0.6572292788290107, 0.23910264318296492, 0.7608973568170351, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.16666666666666666, 0.8238959454956774, 0.1761040545043226, 0.8164529123725907, 0.18354708762740934, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.6220084679281461, 0.3427707211709894, 0.6572292788290107, 0.3149929433932115, 0.6850070566067885, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.04465819873852045, 0.8238959454956774, 0.17610405450432262, 0.7961181677178996, 0.20388183228210038, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.16666666666666663, 0.3427707211709894, 0.6572292788290107, 0.23910264318296492, 0.7608973568170351, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.04465819873852045, 0.8238959454956774, 0.1761040545043226, 0.8164529123725907, 0.18354708762740934, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.16666666666666663, 0.3427707211709894, 0.6572292788290107, 0.3149929433932115, 0.6850070566067885, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.04465819873852046, 0.920120990360615, 0.07987900963938496, 0.8164529123725907, 0.18354708762740934, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.07987900963938496, 0.7886751345948129, 0.16666666666666666, 0.7018874775675312, 0.29811252243246883, 0.3149929433932115, 0.6850070566067885, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.2981125224324688, 0.21132486540518713, 0.04465819873852046, 0.920120990360615, 0.07987900963938498, 0.8923432125828372, 0.10765678741716275, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.07987900963938496, 0.7886751345948129, 0.16666666666666666, 0.7018874775675312, 0.29811252243246883, 0.5982193995795069, 0.4017806004204932, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.2981125224324688, 0.21132486540518713], (80, 2)),
        7 => Array2D::from_data(vec![0.16666666666666669, 0.03522081090086453, 0.2018874775675312, 0.007443033123086744, 0.20933051069061795, 0.00199435471456919, 0.16666666666666669, 0.044658198738520456, 0.2018874775675312, 0.009437387837655933, 0.6220084679281461, 0.13144585576580217, 0.7534543236939484, 0.027777777777777783, 0.7812321014717262, 0.007443033123086743, 0.6220084679281461, 0.16666666666666669, 0.7534543236939484, 0.03522081090086452, 0.16666666666666669, 0.03522081090086453, 0.20188747756753123, 0.0019943547145691905, 0.20388183228210038, 0.007443033123086742, 0.16666666666666669, 0.044658198738520456, 0.2018874775675312, 0.009437387837655933, 0.6220084679281461, 0.13144585576580217, 0.7534543236939484, 0.007443033123086746, 0.7608973568170351, 0.027777777777777776, 0.6220084679281461, 0.16666666666666669, 0.7534543236939484, 0.03522081090086452, 0.16666666666666666, 0.009437387837655933, 0.17610405450432262, 0.02777777777777778, 0.20388183228210038, 0.007443033123086744, 0.16666666666666669, 0.044658198738520456, 0.1761040545043226, 0.03522081090086453, 0.6220084679281461, 0.03522081090086452, 0.6572292788290107, 0.10366807798802437, 0.7608973568170351, 0.027777777777777783, 0.6220084679281461, 0.16666666666666669, 0.6572292788290107, 0.13144585576580217, 0.16666666666666666, 0.009437387837655933, 0.1761040545043226, 0.007443033123086741, 0.18354708762740934, 0.027777777777777787, 0.16666666666666669, 0.044658198738520456, 0.1761040545043226, 0.03522081090086453, 0.6220084679281461, 0.03522081090086452, 0.6572292788290107, 0.027777777777777773, 0.6850070566067885, 0.10366807798802438, 0.6220084679281461, 0.16666666666666669, 0.6572292788290107, 0.13144585576580217, 0.04465819873852045, 0.13144585576580214, 0.17610405450432262, 0.02777777777777778, 0.20388183228210038, 0.007443033123086744, 0.04465819873852045, 0.16666666666666669, 0.1761040545043226, 0.03522081090086453, 0.16666666666666663, 0.490562612162344, 0.6572292788290107, 0.10366807798802437, 0.7608973568170351, 0.027777777777777783, 0.16666666666666663, 0.6220084679281462, 0.6572292788290107, 0.13144585576580217, 0.04465819873852045, 0.13144585576580214, 0.1761040545043226, 0.007443033123086741, 0.18354708762740934, 0.027777777777777787, 0.04465819873852045, 0.16666666666666669, 0.1761040545043226, 0.03522081090086453, 0.16666666666666663, 0.490562612162344, 0.6572292788290107, 0.027777777777777773, 0.6850070566067885, 0.10366807798802438, 0.16666666666666663, 0.6220084679281462, 0.6572292788290107, 0.13144585576580217, 0.04465819873852046, 0.03522081090086451, 0.07987900963938496, 0.10366807798802438, 0.18354708762740934, 0.027777777777777787, 0.04465819873852045, 0.16666666666666669, 0.07987900963938496, 0.13144585576580217, 0.16666666666666666, 0.13144585576580212, 0.29811252243246883, 0.3868945341743197, 0.6850070566067885, 0.10366807798802438, 0.16666666666666663, 0.6220084679281462, 0.2981125224324688, 0.4905626121623441, 0.04465819873852046, 0.03522081090086451, 0.07987900963938498, 0.02777777777777778, 0.10765678741716275, 0.10366807798802438, 0.04465819873852045, 0.16666666666666669, 0.07987900963938496, 0.13144585576580217, 0.16666666666666666, 0.13144585576580212, 0.29811252243246883, 0.10366807798802437, 0.4017806004204932, 0.3868945341743197, 0.16666666666666663, 0.6220084679281462, 0.2981125224324688, 0.4905626121623441, ], (80, 2)),
        10 => Array2D::from_data(vec![0.7981125224324688, 0.16666666666666669, 0.7906694893093821, 0.2018874775675312, 0.7886751345948129, 0.20933051069061795, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.2018874775675312, 0.24654567630605173, 0.6220084679281461, 0.21876789852827383, 0.7534543236939484, 0.21132486540518713, 0.7812321014717262, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.7534543236939484, 0.7981125224324688, 0.16666666666666669, 0.7961181677178996, 0.20188747756753123, 0.7886751345948129, 0.20388183228210038, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.2018874775675312, 0.24654567630605173, 0.6220084679281461, 0.23910264318296492, 0.7534543236939484, 0.21132486540518713, 0.7608973568170351, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.7534543236939484, 0.8238959454956774, 0.16666666666666666, 0.7961181677178996, 0.17610405450432262, 0.7886751345948129, 0.20388183228210038, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.1761040545043226, 0.3427707211709894, 0.6220084679281461, 0.23910264318296492, 0.6572292788290107, 0.21132486540518713, 0.7608973568170351, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.6572292788290107, 0.8238959454956774, 0.16666666666666666, 0.8164529123725907, 0.1761040545043226, 0.7886751345948129, 0.18354708762740934, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.1761040545043226, 0.3427707211709894, 0.6220084679281461, 0.3149929433932115, 0.6572292788290107, 0.21132486540518713, 0.6850070566067885, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.6572292788290107, 0.8238959454956774, 0.04465819873852045, 0.7961181677178996, 0.17610405450432262, 0.7886751345948129, 0.20388183228210038, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.1761040545043226, 0.3427707211709894, 0.16666666666666663, 0.23910264318296492, 0.6572292788290107, 0.21132486540518713, 0.7608973568170351, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.6572292788290107, 0.8238959454956774, 0.04465819873852045, 0.8164529123725907, 0.1761040545043226, 0.7886751345948129, 0.18354708762740934, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.1761040545043226, 0.3427707211709894, 0.16666666666666663, 0.3149929433932115, 0.6572292788290107, 0.21132486540518713, 0.6850070566067885, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.6572292788290107, 0.920120990360615, 0.04465819873852046, 0.8164529123725907, 0.07987900963938496, 0.7886751345948129, 0.18354708762740934, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.07987900963938496, 0.7018874775675312, 0.16666666666666666, 0.3149929433932115, 0.29811252243246883, 0.21132486540518713, 0.6850070566067885, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.2981125224324688, 0.920120990360615, 0.04465819873852046, 0.8923432125828372, 0.07987900963938498, 0.7886751345948129, 0.10765678741716275, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.07987900963938496, 0.7018874775675312, 0.16666666666666666, 0.5982193995795069, 0.29811252243246883, 0.21132486540518713, 0.4017806004204932, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.2981125224324688, ], (80, 2)),
        14 => Array2D::from_data(vec![0.03522081090086453, 0.16666666666666669, 0.007443033123086744, 0.2018874775675312, 0.00199435471456919, 0.20933051069061795, 0.044658198738520456, 0.16666666666666669, 0.009437387837655933, 0.2018874775675312, 0.13144585576580217, 0.6220084679281461, 0.027777777777777783, 0.7534543236939484, 0.007443033123086743, 0.7812321014717262, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.7534543236939484, 0.03522081090086453, 0.16666666666666669, 0.0019943547145691905, 0.20188747756753123, 0.007443033123086742, 0.20388183228210038, 0.044658198738520456, 0.16666666666666669, 0.009437387837655933, 0.2018874775675312, 0.13144585576580217, 0.6220084679281461, 0.007443033123086746, 0.7534543236939484, 0.027777777777777776, 0.7608973568170351, 0.16666666666666669, 0.6220084679281461, 0.03522081090086452, 0.7534543236939484, 0.009437387837655933, 0.16666666666666666, 0.02777777777777778, 0.17610405450432262, 0.007443033123086744, 0.20388183228210038, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.1761040545043226, 0.03522081090086452, 0.6220084679281461, 0.10366807798802437, 0.6572292788290107, 0.027777777777777783, 0.7608973568170351, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.6572292788290107, 0.009437387837655933, 0.16666666666666666, 0.007443033123086741, 0.1761040545043226, 0.027777777777777787, 0.18354708762740934, 0.044658198738520456, 0.16666666666666669, 0.03522081090086453, 0.1761040545043226, 0.03522081090086452, 0.6220084679281461, 0.027777777777777773, 0.6572292788290107, 0.10366807798802438, 0.6850070566067885, 0.16666666666666669, 0.6220084679281461, 0.13144585576580217, 0.6572292788290107, 0.13144585576580214, 0.04465819873852045, 0.02777777777777778, 0.17610405450432262, 0.007443033123086744, 0.20388183228210038, 0.16666666666666669, 0.04465819873852045, 0.03522081090086453, 0.1761040545043226, 0.490562612162344, 0.16666666666666663, 0.10366807798802437, 0.6572292788290107, 0.027777777777777783, 0.7608973568170351, 0.6220084679281462, 0.16666666666666663, 0.13144585576580217, 0.6572292788290107, 0.13144585576580214, 0.04465819873852045, 0.007443033123086741, 0.1761040545043226, 0.027777777777777787, 0.18354708762740934, 0.16666666666666669, 0.04465819873852045, 0.03522081090086453, 0.1761040545043226, 0.490562612162344, 0.16666666666666663, 0.027777777777777773, 0.6572292788290107, 0.10366807798802438, 0.6850070566067885, 0.6220084679281462, 0.16666666666666663, 0.13144585576580217, 0.6572292788290107, 0.03522081090086451, 0.04465819873852046, 0.10366807798802438, 0.07987900963938496, 0.027777777777777787, 0.18354708762740934, 0.16666666666666669, 0.04465819873852045, 0.13144585576580217, 0.07987900963938496, 0.13144585576580212, 0.16666666666666666, 0.3868945341743197, 0.29811252243246883, 0.10366807798802438, 0.6850070566067885, 0.6220084679281462, 0.16666666666666663, 0.4905626121623441, 0.2981125224324688, 0.03522081090086451, 0.04465819873852046, 0.02777777777777778, 0.07987900963938498, 0.10366807798802438, 0.10765678741716275, 0.16666666666666669, 0.04465819873852045, 0.13144585576580217, 0.07987900963938496, 0.13144585576580212, 0.16666666666666666, 0.10366807798802437, 0.29811252243246883, 0.3868945341743197, 0.4017806004204932, 0.6220084679281462, 0.16666666666666663, 0.4905626121623441, 0.2981125224324688, ], (80, 2)),
        15 => Array2D::from_data(vec![0.7981125224324688, 0.03522081090086453, 0.7906694893093821, 0.007443033123086744, 0.7886751345948129, 0.00199435471456919, 0.7886751345948129, 0.044658198738520456, 0.7886751345948129, 0.009437387837655933, 0.24654567630605173, 0.13144585576580217, 0.21876789852827383, 0.027777777777777783, 0.21132486540518713, 0.007443033123086743, 0.21132486540518713, 0.16666666666666669, 0.21132486540518713, 0.03522081090086452, 0.7981125224324688, 0.03522081090086453, 0.7961181677178996, 0.0019943547145691905, 0.7886751345948129, 0.007443033123086742, 0.7886751345948129, 0.044658198738520456, 0.7886751345948129, 0.009437387837655933, 0.24654567630605173, 0.13144585576580217, 0.23910264318296492, 0.007443033123086746, 0.21132486540518713, 0.027777777777777776, 0.21132486540518713, 0.16666666666666669, 0.21132486540518713, 0.03522081090086452, 0.8238959454956774, 0.009437387837655933, 0.7961181677178996, 0.02777777777777778, 0.7886751345948129, 0.007443033123086744, 0.7886751345948129, 0.044658198738520456, 0.7886751345948129, 0.03522081090086453, 0.3427707211709894, 0.03522081090086452, 0.23910264318296492, 0.10366807798802437, 0.21132486540518713, 0.027777777777777783, 0.21132486540518713, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.8238959454956774, 0.009437387837655933, 0.8164529123725907, 0.007443033123086741, 0.7886751345948129, 0.027777777777777787, 0.7886751345948129, 0.044658198738520456, 0.7886751345948129, 0.03522081090086453, 0.3427707211709894, 0.03522081090086452, 0.3149929433932115, 0.027777777777777773, 0.21132486540518713, 0.10366807798802438, 0.21132486540518713, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.8238959454956774, 0.13144585576580214, 0.7961181677178996, 0.02777777777777778, 0.7886751345948129, 0.007443033123086744, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.03522081090086453, 0.3427707211709894, 0.490562612162344, 0.23910264318296492, 0.10366807798802437, 0.21132486540518713, 0.027777777777777783, 0.21132486540518713, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.8238959454956774, 0.13144585576580214, 0.8164529123725907, 0.007443033123086741, 0.7886751345948129, 0.027777777777777787, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.03522081090086453, 0.3427707211709894, 0.490562612162344, 0.3149929433932115, 0.027777777777777773, 0.21132486540518713, 0.10366807798802438, 0.21132486540518713, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.920120990360615, 0.03522081090086451, 0.8164529123725907, 0.10366807798802438, 0.7886751345948129, 0.027777777777777787, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.7018874775675312, 0.13144585576580212, 0.3149929433932115, 0.3868945341743197, 0.21132486540518713, 0.10366807798802438, 0.21132486540518713, 0.6220084679281462, 0.21132486540518713, 0.4905626121623441, 0.920120990360615, 0.03522081090086451, 0.8923432125828372, 0.02777777777777778, 0.7886751345948129, 0.10366807798802438, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.7018874775675312, 0.13144585576580212, 0.5982193995795069, 0.10366807798802437, 0.21132486540518713, 0.3868945341743197, 0.21132486540518713, 0.6220084679281462, 0.21132486540518713, 0.4905626121623441, ], (80, 2)),
        18 => Array2D::from_data(vec![0.16666666666666669, 0.7981125224324688, 0.2018874775675312, 0.7906694893093821, 0.20933051069061795, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.2018874775675312, 0.7886751345948129, 0.6220084679281461, 0.24654567630605173, 0.7534543236939484, 0.21876789852827383, 0.7812321014717262, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.7534543236939484, 0.21132486540518713, 0.16666666666666669, 0.7981125224324688, 0.20188747756753123, 0.7961181677178996, 0.20388183228210038, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.2018874775675312, 0.7886751345948129, 0.6220084679281461, 0.24654567630605173, 0.7534543236939484, 0.23910264318296492, 0.7608973568170351, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.7534543236939484, 0.21132486540518713, 0.16666666666666666, 0.8238959454956774, 0.17610405450432262, 0.7961181677178996, 0.20388183228210038, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.6220084679281461, 0.3427707211709894, 0.6572292788290107, 0.23910264318296492, 0.7608973568170351, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.16666666666666666, 0.8238959454956774, 0.1761040545043226, 0.8164529123725907, 0.18354708762740934, 0.7886751345948129, 0.16666666666666669, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.6220084679281461, 0.3427707211709894, 0.6572292788290107, 0.3149929433932115, 0.6850070566067885, 0.21132486540518713, 0.6220084679281461, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.04465819873852045, 0.8238959454956774, 0.17610405450432262, 0.7961181677178996, 0.20388183228210038, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.16666666666666663, 0.3427707211709894, 0.6572292788290107, 0.23910264318296492, 0.7608973568170351, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.04465819873852045, 0.8238959454956774, 0.1761040545043226, 0.8164529123725907, 0.18354708762740934, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.1761040545043226, 0.7886751345948129, 0.16666666666666663, 0.3427707211709894, 0.6572292788290107, 0.3149929433932115, 0.6850070566067885, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.6572292788290107, 0.21132486540518713, 0.04465819873852046, 0.920120990360615, 0.07987900963938496, 0.8164529123725907, 0.18354708762740934, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.07987900963938496, 0.7886751345948129, 0.16666666666666666, 0.7018874775675312, 0.29811252243246883, 0.3149929433932115, 0.6850070566067885, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.2981125224324688, 0.21132486540518713, 0.04465819873852046, 0.920120990360615, 0.07987900963938498, 0.8923432125828372, 0.10765678741716275, 0.7886751345948129, 0.04465819873852045, 0.7886751345948129, 0.07987900963938496, 0.7886751345948129, 0.16666666666666666, 0.7018874775675312, 0.29811252243246883, 0.5982193995795069, 0.4017806004204932, 0.21132486540518713, 0.16666666666666663, 0.21132486540518713, 0.2981125224324688, 0.21132486540518713, ], (80, 2)),
        19 => Array2D::from_data(vec![0.03522081090086453, 0.009437387837655933, 0.16666666666666669, 0.044658198738520456, 0.13144585576580214, 0.03522081090086453, 0.6220084679281461, 0.16666666666666669, 0.009437387837655936, 0.03522081090086452, 0.16666666666666669, 0.044658198738520456, 0.03522081090086451, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666669, 0.044658198738520456, 0.4905626121623441, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666669, 0.044658198738520456, 0.13144585576580214, 0.4905626121623441, 0.6220084679281461, 0.16666666666666669, 0.03522081090086453, 0.009437387837655933, 0.04465819873852045, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666663, 0.6220084679281462, 0.009437387837655936, 0.03522081090086452, 0.04465819873852045, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.13144585576580214, 0.03522081090086453, 0.04465819873852045, 0.16666666666666669, 0.4905626121623441, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.03522081090086451, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.13144585576580214, 0.4905626121623441, 0.16666666666666663, 0.6220084679281462, ], (32, 2)),
        20 => Array2D::from_data(vec![0.9553418012614795, 0.03522081090086453, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.6220084679281461, 0.9553418012614795, 0.009437387837655936, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.16666666666666669, 0.37799153207185376, 0.4905626121623441, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.16666666666666669, 0.37799153207185376, 0.13144585576580214, 0.21132486540518713, 0.6220084679281461, 0.9553418012614795, 0.03522081090086453, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.16666666666666663, 0.9553418012614795, 0.009437387837655936, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.04465819873852045, 0.37799153207185376, 0.4905626121623441, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.04465819873852045, 0.37799153207185376, 0.13144585576580214, 0.21132486540518713, 0.16666666666666663, ], (32, 2)),
        21 => Array2D::from_data(vec![0.009437387837655933, 0.9553418012614795, 0.044658198738520456, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.03522081090086452, 0.9553418012614795, 0.044658198738520456, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.13144585576580217, 0.37799153207185376, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.4905626121623441, 0.37799153207185376, 0.16666666666666669, 0.21132486540518713, 0.009437387837655933, 0.9553418012614795, 0.16666666666666669, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.03522081090086452, 0.9553418012614795, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.37799153207185376, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.4905626121623441, 0.37799153207185376, 0.6220084679281462, 0.21132486540518713, ], (32, 2)),
        22 => Array2D::from_data(vec![0.03522081090086453, 0.009437387837655933, 0.16666666666666669, 0.044658198738520456, 0.13144585576580214, 0.03522081090086453, 0.6220084679281461, 0.16666666666666669, 0.009437387837655936, 0.03522081090086452, 0.16666666666666669, 0.044658198738520456, 0.03522081090086451, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666669, 0.044658198738520456, 0.4905626121623441, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666669, 0.044658198738520456, 0.13144585576580214, 0.4905626121623441, 0.6220084679281461, 0.16666666666666669, 0.03522081090086453, 0.009437387837655933, 0.04465819873852045, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666663, 0.6220084679281462, 0.009437387837655936, 0.03522081090086452, 0.04465819873852045, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.13144585576580214, 0.03522081090086453, 0.04465819873852045, 0.16666666666666669, 0.4905626121623441, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.03522081090086451, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.13144585576580214, 0.4905626121623441, 0.16666666666666663, 0.6220084679281462, ], (32, 2)),
        23 => Array2D::from_data(vec![0.9553418012614795, 0.03522081090086453, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.6220084679281461, 0.9553418012614795, 0.009437387837655936, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.16666666666666669, 0.37799153207185376, 0.4905626121623441, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.16666666666666669, 0.37799153207185376, 0.13144585576580214, 0.21132486540518713, 0.6220084679281461, 0.9553418012614795, 0.03522081090086453, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.16666666666666663, 0.9553418012614795, 0.009437387837655936, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.04465819873852045, 0.37799153207185376, 0.4905626121623441, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.04465819873852045, 0.37799153207185376, 0.13144585576580214, 0.21132486540518713, 0.16666666666666663, ], (32, 2)),
        24 => Array2D::from_data(vec![0.009437387837655933, 0.9553418012614795, 0.044658198738520456, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.03522081090086452, 0.9553418012614795, 0.044658198738520456, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.13144585576580217, 0.37799153207185376, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.4905626121623441, 0.37799153207185376, 0.16666666666666669, 0.21132486540518713, 0.009437387837655933, 0.9553418012614795, 0.16666666666666669, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.03522081090086452, 0.9553418012614795, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.37799153207185376, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.4905626121623441, 0.37799153207185376, 0.6220084679281462, 0.21132486540518713, ], (32, 2)),
        25 => Array2D::from_data(vec![0.03522081090086453, 0.009437387837655933, 0.16666666666666669, 0.044658198738520456, 0.13144585576580214, 0.03522081090086453, 0.6220084679281461, 0.16666666666666669, 0.009437387837655936, 0.03522081090086452, 0.16666666666666669, 0.044658198738520456, 0.03522081090086451, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666669, 0.044658198738520456, 0.4905626121623441, 0.13144585576580217, 0.6220084679281461, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666669, 0.044658198738520456, 0.13144585576580214, 0.4905626121623441, 0.6220084679281461, 0.16666666666666669, 0.03522081090086453, 0.009437387837655933, 0.04465819873852045, 0.16666666666666669, 0.13144585576580214, 0.03522081090086453, 0.16666666666666663, 0.6220084679281462, 0.009437387837655936, 0.03522081090086452, 0.04465819873852045, 0.16666666666666669, 0.03522081090086451, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.13144585576580214, 0.03522081090086453, 0.04465819873852045, 0.16666666666666669, 0.4905626121623441, 0.13144585576580217, 0.16666666666666663, 0.6220084679281462, 0.03522081090086451, 0.13144585576580217, 0.04465819873852045, 0.16666666666666669, 0.13144585576580214, 0.4905626121623441, 0.16666666666666663, 0.6220084679281462, ], (32, 2)),
        26 => Array2D::from_data(vec![0.9553418012614795, 0.03522081090086453, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.6220084679281461, 0.9553418012614795, 0.009437387837655936, 0.7886751345948129, 0.16666666666666669, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.16666666666666669, 0.37799153207185376, 0.4905626121623441, 0.21132486540518713, 0.6220084679281461, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.16666666666666669, 0.37799153207185376, 0.13144585576580214, 0.21132486540518713, 0.6220084679281461, 0.9553418012614795, 0.03522081090086453, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.13144585576580214, 0.21132486540518713, 0.16666666666666663, 0.9553418012614795, 0.009437387837655936, 0.7886751345948129, 0.04465819873852045, 0.8333333333333333, 0.03522081090086451, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.13144585576580214, 0.7886751345948129, 0.04465819873852045, 0.37799153207185376, 0.4905626121623441, 0.21132486540518713, 0.16666666666666663, 0.8333333333333333, 0.03522081090086451, 0.7886751345948129, 0.04465819873852045, 0.37799153207185376, 0.13144585576580214, 0.21132486540518713, 0.16666666666666663, ], (32, 2)),
        27 => Array2D::from_data(vec![0.009437387837655933, 0.9553418012614795, 0.044658198738520456, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.03522081090086452, 0.9553418012614795, 0.044658198738520456, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.13144585576580217, 0.37799153207185376, 0.16666666666666669, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.044658198738520456, 0.7886751345948129, 0.4905626121623441, 0.37799153207185376, 0.16666666666666669, 0.21132486540518713, 0.009437387837655933, 0.9553418012614795, 0.16666666666666669, 0.7886751345948129, 0.03522081090086453, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.03522081090086452, 0.9553418012614795, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.8333333333333333, 0.6220084679281462, 0.21132486540518713, 0.03522081090086453, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.13144585576580217, 0.37799153207185376, 0.6220084679281462, 0.21132486540518713, 0.13144585576580217, 0.8333333333333333, 0.16666666666666669, 0.7886751345948129, 0.4905626121623441, 0.37799153207185376, 0.6220084679281462, 0.21132486540518713, ], (32, 2)),
        _ => { panic!("Invalid quadrature requested"); }
    };
    #[rustfmt::skip]
    let wts = match qid {
        0 => vec![0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214],
        2 => vec![0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, ],
        6 => vec![0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214],
        7 => vec![0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, ],
        10 => vec![0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, ],
        14 => vec![0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, ],
        15 => vec![0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, ],
        18 => vec![0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.0000055665180748960085, 0.001369227664227106, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.00028935185185185194, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.000026341046351658406, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.000020774528276762397, 0.001369227664227106, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.001079875812375254, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.00007753159503215358, 0.019070881175870563, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.004030151397649164, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.00036688344688400547, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.0002893518518518519, 0.019070881175870563, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, 0.0150407297782214, ],
        19 => vec![0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, ],
        20 => vec![0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, ],
        21 => vec![0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, ],
        22 => vec![0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, ],
        23 => vec![0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, ],
        24 => vec![0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, ],
        25 => vec![0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, ],
        26 => vec![0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, ],
        27 => vec![0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00012464716966057438, 0.00012464716966057438, 0.006479254874251524, 0.006479254874251524, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, 0.00046518957019292144, 0.00046518957019292144, 0.02418090838589498, 0.02418090838589498, ],
        _ => { panic!("Invalid quadrature requested"); }
    };

    let one_over_4pi = 0.25 * std::f64::consts::FRAC_1_PI;

    let test_o0 = test_vertices.get(0, 0).unwrap();
    let test_o1 = test_vertices.get(0, 1).unwrap();
    let test_o2 = test_vertices.get(0, 2).unwrap();
    let test_a00 = test_vertices.get(1, 0).unwrap() - test_vertices.get(0, 0).unwrap();
    let test_a01 = test_vertices.get(1, 1).unwrap() - test_vertices.get(0, 1).unwrap();
    let test_a02 = test_vertices.get(1, 2).unwrap() - test_vertices.get(0, 2).unwrap();
    let test_a10 = test_vertices.get(2, 0).unwrap() - test_vertices.get(0, 0).unwrap();
    let test_a11 = test_vertices.get(2, 1).unwrap() - test_vertices.get(0, 1).unwrap();
    let test_a12 = test_vertices.get(2, 2).unwrap() - test_vertices.get(0, 2).unwrap();

    let trial_o0 = trial_vertices.get(0, 0).unwrap();
    let trial_o1 = trial_vertices.get(0, 1).unwrap();
    let trial_o2 = trial_vertices.get(0, 2).unwrap();
    let trial_a00 = trial_vertices.get(1, 0).unwrap() - trial_vertices.get(0, 0).unwrap();
    let trial_a01 = trial_vertices.get(1, 1).unwrap() - trial_vertices.get(0, 1).unwrap();
    let trial_a02 = trial_vertices.get(1, 2).unwrap() - trial_vertices.get(0, 2).unwrap();
    let trial_a10 = trial_vertices.get(2, 0).unwrap() - trial_vertices.get(0, 0).unwrap();
    let trial_a11 = trial_vertices.get(2, 1).unwrap() - trial_vertices.get(0, 1).unwrap();
    let trial_a12 = trial_vertices.get(2, 2).unwrap() - trial_vertices.get(0, 2).unwrap();

    let test_jdet = f64::sqrt(
        (test_a01 * test_a12 - test_a02 * test_a11).powi(2)
            + (test_a02 * test_a10 - test_a00 * test_a12).powi(2)
            + (test_a00 * test_a11 - test_a01 * test_a10).powi(2),
    );
    let trial_jdet = f64::sqrt(
        (trial_a01 * trial_a12 - trial_a02 * trial_a11).powi(2)
            + (trial_a02 * trial_a10 - trial_a00 * trial_a12).powi(2)
            + (trial_a00 * trial_a11 - trial_a01 * trial_a10).powi(2),
    );

    *result.get_mut(0, 0).unwrap() = 0.0;
    for q in 0..wts.len() {
        let test_x0 = test_points.get(q, 0).unwrap();
        let test_x1 = test_points.get(q, 1).unwrap();
        let test_pt0 = test_o0 + test_x0 * test_a00 + test_x1 * test_a10;
        let test_pt1 = test_o1 + test_x0 * test_a01 + test_x1 * test_a11;
        let test_pt2 = test_o2 + test_x0 * test_a02 + test_x1 * test_a12;
        let trial_x0 = trial_points.get(q, 0).unwrap();
        let trial_x1 = trial_points.get(q, 1).unwrap();
        let trial_pt0 = trial_o0 + trial_x0 * trial_a00 + trial_x1 * trial_a10;
        let trial_pt1 = trial_o1 + trial_x0 * trial_a01 + trial_x1 * trial_a11;
        let trial_pt2 = trial_o2 + trial_x0 * trial_a02 + trial_x1 * trial_a12;

        let sum_squares = (test_pt0 - trial_pt0).powi(2)
            + (test_pt1 - trial_pt1).powi(2)
            + (test_pt2 - trial_pt2).powi(2);
        let distance = f64::sqrt(sum_squares);

        *result.get_mut(0, 0).unwrap() += wts[q] * test_jdet * trial_jdet * one_over_4pi / distance;
    }
}

fn nonneighbour_kernel_dp0<'a>(
    result: &mut impl Array2DAccess<'a, f64>,
    test_vertices: &impl Array2DAccess<'a, f64>,
    trial_vertices: &impl Array2DAccess<'a, f64>,
) {
    #[rustfmt::skip]
    let pts = Array2D::from_data(vec![0.3333333333333333, 0.3333333333333333, 0.4951734598011705, 0.4951734598011705, 0.019139415242841296, 0.019139415242841296, 0.18448501268524653, 0.18448501268524653, 0.42823482094371884, 0.42823482094371884, 0.4951734598011705, 0.009653080397658997, 0.019139415242841296, 0.9617211695143174, 0.18448501268524653, 0.6310299746295069, 0.42823482094371884, 0.14353035811256232, 0.009653080397658997, 0.4951734598011705, 0.9617211695143174, 0.019139415242841296, 0.6310299746295069, 0.18448501268524653, 0.14353035811256232, 0.42823482094371884, 0.03472362048232748, 0.13373475510086913, 0.03758272734119169, 0.3266931362813369, 0.8315416244168035, 0.03472362048232748, 0.6357241363774714, 0.03758272734119169, 0.13373475510086913, 0.8315416244168035, 0.3266931362813369, 0.6357241363774714, 0.13373475510086913, 0.03472362048232748, 0.3266931362813369, 0.03758272734119169, 0.8315416244168035, 0.13373475510086913, 0.6357241363774714, 0.3266931362813369, 0.03472362048232748, 0.8315416244168035, 0.03758272734119169, 0.6357241363774714], (25, 2));
    #[rustfmt::skip]
    let wts = vec![0.041807437186986963, 0.004896295249209152, 0.003192679615059327, 0.039316884873188636, 0.03762366398427199, 0.004896295249209152, 0.003192679615059327, 0.039316884873188636, 0.03762366398427199, 0.004896295249209152, 0.003192679615059327, 0.039316884873188636, 0.03762366398427199, 0.014481140731628171, 0.019369524543009452, 0.014481140731628171, 0.019369524543009452, 0.014481140731628171, 0.019369524543009452, 0.014481140731628171, 0.019369524543009452, 0.014481140731628171, 0.019369524543009452, 0.014481140731628171, 0.019369524543009452];

    let one_over_4pi = 0.25 * std::f64::consts::FRAC_1_PI;

    let test_o0 = test_vertices.get(0, 0).unwrap();
    let test_o1 = test_vertices.get(0, 1).unwrap();
    let test_o2 = test_vertices.get(0, 2).unwrap();
    let test_a00 = test_vertices.get(1, 0).unwrap() - test_vertices.get(0, 0).unwrap();
    let test_a01 = test_vertices.get(1, 1).unwrap() - test_vertices.get(0, 1).unwrap();
    let test_a02 = test_vertices.get(1, 2).unwrap() - test_vertices.get(0, 2).unwrap();
    let test_a10 = test_vertices.get(2, 0).unwrap() - test_vertices.get(0, 0).unwrap();
    let test_a11 = test_vertices.get(2, 1).unwrap() - test_vertices.get(0, 1).unwrap();
    let test_a12 = test_vertices.get(2, 2).unwrap() - test_vertices.get(0, 2).unwrap();

    let trial_o0 = trial_vertices.get(0, 0).unwrap();
    let trial_o1 = trial_vertices.get(0, 1).unwrap();
    let trial_o2 = trial_vertices.get(0, 2).unwrap();
    let trial_a00 = trial_vertices.get(1, 0).unwrap() - trial_vertices.get(0, 0).unwrap();
    let trial_a01 = trial_vertices.get(1, 1).unwrap() - trial_vertices.get(0, 1).unwrap();
    let trial_a02 = trial_vertices.get(1, 2).unwrap() - trial_vertices.get(0, 2).unwrap();
    let trial_a10 = trial_vertices.get(2, 0).unwrap() - trial_vertices.get(0, 0).unwrap();
    let trial_a11 = trial_vertices.get(2, 1).unwrap() - trial_vertices.get(0, 1).unwrap();
    let trial_a12 = trial_vertices.get(2, 2).unwrap() - trial_vertices.get(0, 2).unwrap();

    let test_jdet = f64::sqrt(
        (test_a01 * test_a12 - test_a02 * test_a11).powi(2)
            + (test_a02 * test_a10 - test_a00 * test_a12).powi(2)
            + (test_a00 * test_a11 - test_a01 * test_a10).powi(2),
    );
    let trial_jdet = f64::sqrt(
        (trial_a01 * trial_a12 - trial_a02 * trial_a11).powi(2)
            + (trial_a02 * trial_a10 - trial_a00 * trial_a12).powi(2)
            + (trial_a00 * trial_a11 - trial_a01 * trial_a10).powi(2),
    );

    *result.get_mut(0, 0).unwrap() = 0.0;
    for test_q in 0..wts.len() {
        let test_x0 = pts.get(test_q, 0).unwrap();
        let test_x1 = pts.get(test_q, 1).unwrap();
        let test_pt0 = test_o0 + test_x0 * test_a00 + test_x1 * test_a10;
        let test_pt1 = test_o1 + test_x0 * test_a01 + test_x1 * test_a11;
        let test_pt2 = test_o2 + test_x0 * test_a02 + test_x1 * test_a12;
        for trial_q in 0..wts.len() {
            let trial_x0 = pts.get(trial_q, 0).unwrap();
            let trial_x1 = pts.get(trial_q, 1).unwrap();
            let trial_pt0 = trial_o0 + trial_x0 * trial_a00 + trial_x1 * trial_a10;
            let trial_pt1 = trial_o1 + trial_x0 * trial_a01 + trial_x1 * trial_a11;
            let trial_pt2 = trial_o2 + trial_x0 * trial_a02 + trial_x1 * trial_a12;

            let sum_squares = (test_pt0 - trial_pt0).powi(2)
                + (test_pt1 - trial_pt1).powi(2)
                + (test_pt2 - trial_pt2).powi(2);
            let distance = f64::sqrt(sum_squares);

            *result.get_mut(0, 0).unwrap() +=
                wts[test_q] * wts[trial_q] * test_jdet * trial_jdet * one_over_4pi / distance;
        }
    }
}

fn main() {
    let grid = regular_sphere(3);
    let element = create_element(
        ElementFamily::Lagrange,
        ReferenceCellType::Triangle,
        0,
        true,
    );

    let space = SerialFunctionSpace::new(&grid, &element);

    // --------------------------------------------- //
    // Assemble DP0, DP0 single layer Laplace kernel //
    // --------------------------------------------- //
    let mut matrix2 =
        Array2D::<f64>::new((space.dofmap().global_size(), space.dofmap().global_size()));

    let start = Instant::now();

    // TODO: allow user to configure this

    let mut local_result = Array2D::<f64>::new((1, 1));

    let mut test_vertices = Array2D::<f64>::new((3, 3));
    let mut trial_vertices = Array2D::<f64>::new((3, 3));

    let c20 = grid.topology().connectivity(2, 0);
    for test_cell in 0..grid.geometry().cell_count() {
        let test_cell_tindex = grid.topology().index_map()[test_cell];
        let test_dofs = space.dofmap().cell_dofs(test_cell_tindex).unwrap();
        let test_cell_dofs = grid.geometry().cell_vertices(test_cell).unwrap();
        let test_tvertices = c20.row(test_cell_tindex).unwrap();

        for i in 0..3 {
            for j in 0..3 {
                *test_vertices.get_mut(i, j).unwrap() =
                    grid.geometry().point(test_cell_dofs[i]).unwrap()[j];
            }
        }

        // TODO: Add iterators that loop over cells with certain connectivity rather than ifs
        for trial_cell in 0..grid.geometry().cell_count() {
            let trial_cell_tindex = grid.topology().index_map()[trial_cell];
            let trial_dofs = space.dofmap().cell_dofs(trial_cell_tindex).unwrap();
            let trial_cell_dofs = grid.geometry().cell_vertices(trial_cell).unwrap();
            let trial_tvertices = c20.row(trial_cell_tindex).unwrap();

            for i in 0..3 {
                for j in 0..3 {
                    *trial_vertices.get_mut(i, j).unwrap() =
                        grid.geometry().point(trial_cell_dofs[i]).unwrap()[j];
                }
            }

            if test_cell == trial_cell {
                singular_kernel_dp0(&mut local_result, &test_vertices, &trial_vertices, 0);
            } else {
                let mut pairs = vec![];
                for (test_i, test_v) in test_tvertices.iter().enumerate() {
                    for (trial_i, trial_v) in trial_tvertices.iter().enumerate() {
                        if test_v == trial_v {
                            pairs.push((test_i, trial_i));
                        }
                    }
                }
                if pairs.len() == 2 {
                    let qid = 1
                        + 6 * (pairs[0].0 + pairs[1].0)
                        + (pairs[0].1 * pairs[0].1 * (pairs[1].1 - 1) + 7 * pairs[0].1) / 2
                        + pairs[1].1 * (1 - pairs[0].1)
                        - 7;
                    singular_kernel_dp0(&mut local_result, &test_vertices, &trial_vertices, qid);
                } else if pairs.len() == 1 {
                    let qid = 19 + 3 * pairs[0].0 + pairs[0].1;
                    singular_kernel_dp0(&mut local_result, &test_vertices, &trial_vertices, qid);
                } else {
                    // TODO: non-neighbour kernel
                    nonneighbour_kernel_dp0(&mut local_result, &test_vertices, &trial_vertices);
                }
            }

            for (test_i, test_dof) in test_dofs.iter().enumerate() {
                for (trial_i, trial_dof) in trial_dofs.iter().enumerate() {
                    *matrix2.get_mut(*test_dof, *trial_dof).unwrap() =
                        *local_result.get(test_i, trial_i).unwrap()
                }
            }
        }
    }
    println!(
        "Time taken (single layer Laplace, grid with {} cells):  {}ms",
        grid.topology().entity_count(2),
        start.elapsed().as_millis()
    );

    let start2 = Instant::now();
    let mut matrix =
        Array2D::<f64>::new((space.dofmap().global_size(), space.dofmap().global_size()));

    assemble_dense(
        &mut matrix,
        BoundaryOperator::SingleLayer,
        PDEType::Laplace,
        &space,
        &space,
    );
    println!(
        "Time taken (current slow assembly, grid with {} cells): {}ms",
        grid.topology().entity_count(2),
        start2.elapsed().as_millis()
    );

    // Check correctness
    for i in 0..space.dofmap().global_size() {
        for j in 0..space.dofmap().global_size() {
            // epsilon is large here, as low degree quadrature rules are used by th kernel functions in this file
            assert_relative_eq!(
                matrix.get(i, j).unwrap(),
                matrix2.get(i, j).unwrap(),
                epsilon = 1e-2
            );
        }
    }
}
